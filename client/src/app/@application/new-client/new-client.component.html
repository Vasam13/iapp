<pg-container
  extraHorizontalClass="p-l-0 p-r-0"
  extraClass="sm-p-l-0 sm-p-r-0"
>
  <div
    class="inner"
    pg-parallax
  >
    <ol class="breadcrumb">
      <li
        class="breadcrumb-item breadcrumb-last-link"
        (click)="gotoClients()"
      >Clients</li>
      <li class="breadcrumb-item active">
        <span *ngIf="!clientId">New</span>
        <span *ngIf="clientId">#{{clientId}}</span>
      </li>
    </ol>
  </div>
</pg-container>
<div class="row">
  <div class="col-md-12 p-l-35 p-r-35">
    <div class="card card-transparent">
      <div class="card-body p-t-0">
        <form
          #form="ngForm"
          id="new-client-form"
          role="form"
          autocomplete="on"
          [formGroup]="clientForm"
          (ngSubmit)="save()"
        >
          <p>
            <em class="icon-user m-l-5"></em>&nbsp;&nbsp;Client Details </p>
          <div
            class="form-group-attached"
            formGroupName="clientDetails"
          >
            <div class="row clearfix">
              <div class="col-md-12">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('clientName')"
                >
                  <label>Client</label>
                  <input
                    type="text"
                    class="form-control"
                    name="clientName"
                    formControlName="clientName"
                    required
                  >
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-md-4">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('contactName')"
                >
                  <label>Contact Name</label>
                  <input
                    type="text"
                    class="form-control"
                    name="contactName"
                    formControlName="contactName"
                    required
                  > </div>
              </div>
              <div class="col-md-4">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('emailAddress')"
                >
                  <label>Email</label>
                  <input
                    type="text"
                    class="form-control"
                    name="emailAddress"
                    formControlName="emailAddress"
                  > </div>
              </div>
              <div class="col-md-4">
                <div class="form-group form-group-default">
                  <label>Website</label>
                  <input
                    type="text"
                    class="form-control"
                    name="website"
                    formControlName="website"
                  > </div>
              </div>
            </div>

            <div class="row clearfix">
              <div class="col-md-4">
                <div class="form-group form-group-default">
                  <label>Country Code</label>
                  <input
                    type="text"
                    class="form-control"
                    name="phone1CountryCode"
                    formControlName="phone1CountryCode"
                  > </div>
              </div>
              <div class="col-md-4">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid( 'phone1Number')"
                >
                  <label>Phone Number 1</label>
                  <input
                    type="number"
                    class="form-control"
                    name="phone1Number"
                    formControlName="phone1Number"
                    required
                  >
                  <div
                    class="invalid-tooltip"
                    *ngIf="isFieldValid( 'phone1Number')"
                  > This field is required. </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group form-group-default">
                  <label>Extension</label>
                  <input
                    type="text"
                    class="form-control"
                    name="phone1Extension"
                    formControlName="phone1Ext"
                  > </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-md-4">
                <div class="form-group form-group-default">
                  <label>Country Code</label>
                  <input
                    type="text"
                    class="form-control"
                    name="phone2CountryCode"
                    formControlName="phone2CountryCode"
                  > </div>
              </div>
              <div class="col-md-4">
                <div class="form-group form-group-default">
                  <label>Phone Number 2</label>
                  <input
                    type="number"
                    class="form-control"
                    name="phone2Number"
                    formControlName="phone2Number"
                  > </div>
              </div>
              <div class="col-md-4">
                <div class="form-group form-group-default">
                  <label>Extension</label>
                  <input
                    type="text"
                    class="form-control"
                    name="phone2Extension"
                    formControlName="phone2Ext"
                  > </div>
              </div>
            </div>

            <!-- Client Address form -->
            <div class="row clearfix">
              <div class="col-md-6">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('addressLine1')"
                >
                  <label>Address Line1</label>
                  <input
                    type="text"
                    class="form-control"
                    name="addressLine1"
                    formControlName="addressLine1"
                    required
                  >
                  <div
                    class="invalid-tooltip"
                    *ngIf="isFieldValid('addressLine1')"
                  > This field is required. </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group form-group-default">
                  <label>Address Line2</label>
                  <input
                    type="text"
                    class="form-control"
                    name="addressLine2"
                    formControlName="addressLine2"
                  > </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-md-6">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('country')"
                >
                  <label>Country</label>
                  <pg-select
                    (OpenChange)="onCountryChange($event)"
                    style="width: 100%;"
                    formControlName="country"
                    [PlaceHolder]="'Select Option...'"
                    AllowClear
                    ShowSearch
                    required
                  >
                    <pg-option
                      *ngFor="let country of countryStore.rows"
                      [Label]="country.name"
                      [Value]="country.name"
                    > </pg-option>
                  </pg-select>


                </div>
              </div>
              <div class="col-md-6">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('state')"
                >
                  <label>State</label>
                  <pg-select
                    (OpenChange)="onStateChange($event)"
                    style="width: 100%;"
                    formControlName="state"
                    [PlaceHolder]="'Select Option'"
                    AllowClear
                    ShowSearch
                    required
                  >
                    <pg-option
                      *ngFor="let state of statesStore.rows"
                      [Label]="state.name"
                      [Value]="state.name"
                    > </pg-option>
                  </pg-select>
                </div>
              </div>
            </div>
            <div class="row clearfix">
              <div class="col-md-6">
                <div
                  class="form-group form-group-default required"
                  [class.has-error]="isFieldValid('city')"
                >
                  <label>
                    <div>
                      <span>City</span>
                      <span
                        (click)="openNewCityPopup()"
                        class="add-new-option-link"
                      >
                        Not found? Click here
                      </span>
                    </div>
                  </label>
                  <pg-select
                    style="width: 100%;"
                    formControlName="city"
                    [PlaceHolder]="'Select Option'"
                    AllowClear
                    ShowSearch
                    required
                  >
                    <pg-option
                      *ngFor="let city of citiesStore.rows"
                      [Label]="city.name"
                      [Value]="city.name"
                    > </pg-option>
                  </pg-select>
                  <div
                    class="invalid-tooltip"
                    *ngIf="isFieldValid('city')"
                  > This field is required. </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group form-group-default">
                  <label>Zip</label>
                  <input
                    type="text"
                    class="form-control"
                    name="zip"
                    formControlName="zip"
                  > </div>
              </div>
            </div>
          </div>
          <div class="row clearfix">
            <div class="col-sm-12 col-lg-12 col-md-12 text-center">
              <button
                class="btn btn-primary  m-t-10"
                type="submit"
              >Save</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div
  bsModal
  #addNewCityModal="bs-modal"
  class="modal fade slide-up disable-scroll"
  tabindex="-1"
  role="dialog"
  aria-hidden="false"
>
  <div class="modal-dialog modal-md">
    <div class="modal-content-wrapper">
      <div class="modal-content">
        <div class="modal-body">
          <div class="row">
            <div class="col-md-12 m-t-20">
              <form>
                <div class="row">
                  <div class="col-md-12">
                    <label>
                      Add New City
                    </label>
                    <div class="
                          form-group">
                      <input
                        type="text"
                        class="form-control"
                        name="remarks"
                        placeholder="Enter City Name"
                        [(ngModel)]="newCityEntered"
                      >
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12 m-t-10  text-center">
              <button
                class="btn btn-tag btn-complete  btn-tag-primary btn-tag-rounded m-r-5"
                (click)="addNewCity()"
                type="button"
                [disabled]="!newCityEntered || citiesStore.isBusy"
              >Save</button>
              <button
                class="btn btn-tag btn-complete  btn-tag-primary btn-tag-rounded m-r-5"
                (click)="addNewCityModal.hide()"
                type="button"
              >Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
